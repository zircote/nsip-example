---
# Weekly Farm Task Reminder
# Creates a reminder issue every Monday at 8 AM UTC
#
# Learners: This is an example of a scheduled workflow.
# Modify the schedule, title, and body to fit your needs.

name: Weekly Farm Reminder

"on":
  schedule:
    # Runs every Monday at 8:00 AM UTC
    - cron: '0 8 * * 1'

  # Allows manual triggering from the Actions tab
  workflow_dispatch:

jobs:
  create-reminder:
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Create weekly reminder issue
        uses: actions/github-script@v7
        with:
          script: |
            const today = new Date();
            const start = new Date(today.getFullYear(), 0, 1);
            const diff = today - start;
            const weekNumber = Math.ceil(diff / 604800000);

            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `Weekly Farm Check - Week ${weekNumber}`,
              labels: ['routine', 'maintenance'],
              body: `## Weekly Farm Checklist

            It's Monday! Time for our weekly farm review.

            ### Equipment
            - [ ] Check fluid levels on all tractors
            - [ ] Inspect tire pressure on vehicles
            - [ ] Review maintenance log for upcoming service

            ### Livestock
            - [ ] Verify all water sources are working
            - [ ] Check feed inventory levels
            - [ ] Review health records for follow-ups needed

            ### Garden/Pasture
            - [ ] Scout garden beds for pest or disease signs
            - [ ] Check pasture fencing and rotational grazing
            - [ ] Review weather forecast for the week

            ### Land & Ecology
            - [ ] Walk monitoring sites if seasonal assessment is due
            - [ ] Check photo points if conditions have changed
            - [ ] Note any erosion, bare soil, or unusual vegetation
            - [ ] Update grazing rotation notes in eov/

            ### Administrative
            - [ ] Review any open issues from last week
            - [ ] Update project board with completed tasks
            - [ ] Plan priorities for the week ahead

            ---
            *This issue was automatically created by GitHub Actions.*
            `
            });
